(()=>{"use strict";const t={COLLECTION:"productcomparator",DOCSEVENT:"docs event",ABOUT:"about",CONFIG:"config",SEEALL:"see all",SHEETNAME:"campaign_calendar",NAME:"Campaign Calendar",TANDCS:"Campaign Calendar T & Cs",FOCUS:"focus",BUILD:"build",RESET:"reset",TABLISTENER:"tab listener",INSESSION:"in session",AFTERSESSION:"after session",BTWORB4SESSION:"between or before session",TIMESLOTSTODISPLAY:12,SKUROWQUERY:".-sku_row",MAINELQUERY:".-main-el",FLIPPERQUERY:".-flipper",FLIPPERBACKQUERY:".-flipper .-back",SUPERBLOCKTITLEQUERY:".-similar-products",SWITCHQUERY:".-switcher",SELECTIONQUERY:".-selection",SEARCHINPUTQUERY:".-search-input",LIVECLASS:"-live",SEARCHING:"searching",OOSCLASS:"-oos",TABCLASS:"-tab",CATTYPE:"category",DIRBTN:"dir-btn",COMPARE:"compare",SELECTIONBTN:"selection-btn",SEARCHBTN:"search-btn",AM:"am",PM:"pm",TODAY:"today",YESTERDAY:"yesterday",TOMORROW:"tomorrow",PREFIX:"prefix",FREE:"FREE",INITIATIVE:"Campaign Calendar",TANDCSQUERY:".-re.-rules",HOWITWORKSQUERY:".-how-it-works",TOPBANNERQUERY:".-banner.-top",FROMSTART:"from start",CLICK:"click",SHOWCLASS:"-show",TXTCLASS:".-txt",CLOSE:"Close",TERMSANDCONDIIONS:"Terms & Conditions",BANNERQUERY:".-banner.-top img.lazy-image",DATASRC:"data-src",KEYWORDS:["with","and","tv"],TABQUERY:".-tab",TABSQUERY:".-all-tabs",TABSPARENTQUERY:".-tabs",PREVQUERY:".-control.-prev",NEXTQUERY:".-control.-next",FIRSTTAB:"first tab",ACTIVECLASS:"active",DATATIME:"data-time",NEXT:"next",PREV:"prev",SKUSELQUERY:".-skus",SKUROWCLASS:"-sku_row -posrel"},s=t=>"#initiative "+t;class e{constructor(e,i){var a;this.timeInterval=0,this.isMobile=navigator.userAgent.toLowerCase().includes("mobi"),this.remoteData=e,this.currency=this.remoteData.config.currency,this.config=this.remoteData.config,this.domain=null===(a=this.remoteData.config)||void 0===a?void 0:a.domain,this.catalog=`${this.domain}/catalog/?shipped_from=country_local&seller_score=3-5&q=`,this.fbox=i,this.el=(t,e)=>e?e.querySelector(s(t)):document.querySelector(s(t)),this.all=(t,e)=>e?e.querySelectorAll(s(t)):document.querySelectorAll(s(t)),this.pad=t=>1==t.toString().length?"0"+t:t,this.capitalize=t=>t[0].toUpperCase()+t.slice(1),this.isATab=s=>s.classList.contains(t.TABCLASS),this.midnight=t=>+new Date(t).setHours(0,0,0,0)}times(t){const s=t.map((t=>this.midnight(t.time)));return Array.from(new Set(s)).sort(((t,s)=>t-s))}timeUnits(t){const s=new Date(t);return{day:s.getDay(),month:s.getMonth(),date:s.getDate(),hour:s.getHours(),mins:s.getMinutes()}}twelveHrFormat(s,e){return 12===s?`${this.pad(s)}:${this.pad(e)}${t.PM}`:s>12?`${this.pad(s-12)}:${this.pad(e)}${t.PM}`:0===s?`12:${this.pad(e)}${t.AM}`:`${this.pad(s)}:${this.pad(e)}${t.AM}`}dayDiff(t){const s=new Date(t).getDate();return(new Date).getDate()-s}sameMonth(t){return new Date(t).getMonth()===(new Date).getMonth()}date(s){const e=this.dayDiff(s);return 0===e&&this.sameMonth(s)?this.capitalize(t.TODAY):1===e&&this.sameMonth(s)?this.capitalize(t.YESTERDAY):-1===e&&this.sameMonth(s)?this.capitalize(t.TOMORROW):this.fullDate(s)}fullDate(t){const s=new Date(t),e=s.toLocaleDateString("en-US",{month:"short"});return`${s.toLocaleDateString("en-US",{weekday:"short"})} ${e} ${s.getDate()}`}toggle(t,s,e){t.forEach((t=>t.classList.remove(e))),s.classList.add(e)}price(t){const s=this.numFromStr(t);return`${this.currency} ${Number(s).toLocaleString()}`}numFromStr(t){const s=t.match(/\d/g);return s?s.join(""):0}formatPrice(s){const e=s.split(" "),i=Number(e[1].replace("â‚¦",""));return isNaN(i)?s:this.config.currencyPosition===t.PREFIX?`Below ${this.currency} ${i.toLocaleString()}`:`Below ${i.toLocaleString()} ${this.currency}`}discount(t,s){const e=100*(Number(t)-Number(s))/Number(t);return isNaN(e)?"":`-${Math.round(e)}%`}replacePattern(t,s){const e=new RegExp(t,"g");return s.replace(e,"-")}id(t,s){const e=this.replacePattern("'",t),i=this.replacePattern("&",e);return this.replacePattern("%",i).toLowerCase().split(" ").join(s)}key(t,s){return t}timeFormat(t){const s=this.timeUnits(t),e=this.twelveHrFormat(s.hour,s.mins);return`${this.date(t)}'s ${e} sale`}show(){let t=new this.fbox.ImageObserver;return t=null,this}platform(){const s="ontouchstart"in window,e=(t.SHEETNAME,t.SHEETNAME,t.SHEETNAME,this.config.mobileAppBanner),i=this.config.desktopBanner;return{banner:s?e:i}}rating(t){return(t/5*100).toFixed(2)+"%"}productProperties(s){const e=s.displayName.split(" "),i=null==e?void 0:e.length,a=[];for(let r=0;r<i;r++){const i=e[r].toLowerCase();if(i.length<2)continue;if(s.singularName.indexOf(i)>-1)continue;if(t.KEYWORDS.indexOf(i)>-1)continue;const l=i.trim().replace(")","").replace("(","");a.push(l)}return a}randomize(t){return[...t].sort((()=>Math.random()-.5))}pluralize(t){switch(t[t.length-1]){case"y":return t.substring(0,t.length-1)+"ies";case"s":return t;default:return t+"s"}}}class i extends e{constructor(t,s){super(t,s)}mobile(t){const s=t.indexOf('"products":'),e="{"+t.substring(s,t.length),i=e.indexOf(',"head"');return e.substring(0,i-1)+"}"}desktop(t){var s=t.indexOf('"products":'),e="{"+t.substring(s,t.length),i=this.braceIndices(e,this.escape("}]")),a=i[i.length-1];return e.substring(0,a+2)+"}"}braceIndices(t,s){for(var e,i=new RegExp(s,"gi"),a=[];e=i.exec(t);)a.push(e.index);return a}escape(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}products(t){return s=this,e=void 0,a=function*(){const s=yield fetch(t),e=yield s.text(),i=this.isMobile?this.mobile(e):this.desktop(e);let a=[];try{localStorage.setItem("apiProducts",i),a=JSON.parse(i).products}catch(t){console.info(t),a=[]}return a},new((i=void 0)||(i=Promise))((function(t,r){function l(t){try{o(a.next(t))}catch(t){r(t)}}function n(t){try{o(a.throw(t))}catch(t){r(t)}}function o(s){var e;s.done?t(s.value):(e=s.value,e instanceof i?e:new i((function(t){t(e)}))).then(l,n)}o((a=a.apply(s,e||[])).next())}));var s,e,i,a}escapeStr(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}}class a extends e{constructor(s,e){super(s,e),this.api=new i(s,e),this.tandcs=s.about,this.categories=s.categories,this.productMap=[],this.filters=[],this.tandcsEl=this.el(t.TANDCSQUERY),this.hiwCTA=this.el(t.HOWITWORKSQUERY),this.topBanner=this.el(t.TOPBANNERQUERY),this.mainEl=this.el(t.MAINELQUERY),this.flipper=this.el(t.FLIPPERQUERY),this.flipperBack=this.el(t.FLIPPERBACKQUERY),this.switchBtn=this.el(t.SWITCHQUERY),this.selection=this.el(t.SELECTIONQUERY),this.superblockTitle=this.el(t.SUPERBLOCKTITLEQUERY),this.searchInput=this.el(t.SEARCHINPUTQUERY),this.hiwCTA.addEventListener(t.CLICK,this.toggleBanner.bind(this)),this.fbox.pubsub.subscribe(t.RESET,this.init.bind(this)),this.init().setBanner().displayTAndCs().show().listeners()}init(){const s=this.randomize(this.categories);return this.mainEl.innerHTML=this.buildSuperblock(s),this.flipper=this.el(t.FLIPPERQUERY),this.flipperBack=this.el(t.FLIPPERBACKQUERY),this.switchBtn=this.el(t.SWITCHQUERY),this.superblockTitle=this.el(t.SUPERBLOCKTITLEQUERY),this.searchInput=this.el(t.SEARCHINPUTQUERY),this.switchBtn.addEventListener("click",(()=>{[this.selection,this.flipper].forEach((t=>t.classList.toggle("-switch"))),this.positionAndUpdateAfterFlip()})),this}positionAndUpdateAfterFlip(t){const s=this.flipper.classList.contains("-switch");this.superblockTitle.innerHTML=s?`More ${null!=t?t:""}`:"Categories",this.flipper.scrollTop=0,this.flipper.scrollLeft=0}listeners(){this.mainEl.addEventListener("click",this.handleClick.bind(this)),this.topBanner.addEventListener("click",this.handleClick.bind(this))}handleClick(s){const e=s.target;switch(e.getAttribute("data-type")){case t.CATTYPE:const s=e.getAttribute("data-category");this.updateProductFloor(s);break;case t.DIRBTN:const i=e.getAttribute("data-dir"),a=e.parentElement,r=this.el(".-product-scrollable",a).parentElement;i===t.NEXT?this.scrollTonext(r):this.scrollToprev(r);break;case t.SEEALL:const l=e.getAttribute("data-href");location.href=l;break;case t.COMPARE:this.updateSelection(e);break;case t.SELECTIONBTN:this.btnFilterUpdate(e);break;case t.SEARCHBTN:this.searchBtnFilterUpdate(e)}}btnFilterUpdate(t){const s=t.getAttribute("data-name"),e=t.parentElement;if(null==e||e.classList.toggle("active"),null==e?void 0:e.classList.contains("active"))this.filters.unshift(s);else{let t=this.filters.join("-");t=t.replace(s,"");const e=t.split("-").filter((t=>""!==t));this.filters=e}this.apiRequest()}searchBtnFilterUpdate(s){const e=s.parentElement,i=this.searchInput.value;if(i.length>0){this.updateFilters(i);const s={approved:"true",image:"",plural_name:this.pluralize(i),price_point:"top deals",singular_name:i,sku_count:"0",skus:[],url:""};null==e||e.classList.add(t.SEARCHING),this.apiCall().then((a=>{null==e||e.classList.remove(t.SEARCHING),this.productMap=a,this.productFloorUiUpdate({catObj:s,desc:"top deals",name:i,skus:a})})).catch((s=>null==e?void 0:e.classList.remove(t.SEARCHING)))}}updateSelection(t){const s=this.selectionObject(t);this.updateFilters(s.singularName),this.updateSelectionUi(s),this.flipAndPopulateSimilarProducts(s)}updateFilters(t){this.filters=[t]}updateSelectionUi(t){const s=this.selectionHtml(t);this.el(".-back",this.selection).innerHTML=s,this.show()}flipAndPopulateSimilarProducts(t){this.flipSimilarProducts(t),this.apiRequest()}apiRequest(){this.flipperBack.innerHTML=this.spinLoader(),this.apiCall().then(this.populateSimilarProducts.bind(this))}apiCall(){const t=this.catalog+this.filters.join("+");return this.api.products(t)}flipSimilarProducts(t){const s=this.selection.classList,e=this.flipper.classList;!s.contains("-switch")&&s.add("-switch"),!e.contains("-switch")&&e.add("-switch"),this.positionAndUpdateAfterFlip(t.pluralName)}populateSimilarProducts(t){console.log("data",t),this.flipperBack.innerHTML=t.map(this.skuHtmlHorizontal.bind(this)).join(""),this.show()}selectionObject(t){var s;const e=t.getAttribute("data-singular-name").toLowerCase(),i=t.getAttribute("data-plural-name").toLowerCase(),a=t.getAttribute("data-sku"),r=null===(s=this.productMap)||void 0===s?void 0:s.find((t=>t.sku===a)),l={displayName:r.displayName,singularName:e};return r.properties=this.productProperties(l),r.singularName=e,r.pluralName=i,r}oldPriceAndDiscount(t){return`<div class="-price -old">${t.prices.oldPrice}</div><div class="-discount">${t.prices.discount}</div>`}selectionHtml(t){var s;const e=null===(s=t.properties)||void 0===s?void 0:s.map(this.btnHtml.bind(this)).join(""),i=t.prices.oldPrice?this.oldPriceAndDiscount(t):"";return`<div class="-sku -posrel" data-sku="${t.sku}"><a href="${t.url}" target="_blank" class="-img -posrel"><span class="-posabs -preloader -hide"></span><img class="lazy-image" data-src="${t.image}" alt="sku_img"></a><div class="-details"><div class="-detail-props"><div class="-name">${t.displayName}</div><div class="-prices"><div class="-price -new">${t.prices.price}</div>${i} </div></div><div class="-btns">${e}</div></div></div>`}btnHtml(t){return`<div class="-btn -cta -posrel"><div class="-btn-clickable -posabs" data-name="${t}" data-type="selection-btn"></div><div class="-txt">${t}</div></div>`}scrollTonext(t){var s=t.scrollLeft+80,e=t.scrollLeft+300-s;t.scrollLeft=s+1*e}scrollToprev(t){var s=t.scrollLeft-80,e=t.scrollLeft-300-s;t.scrollLeft=s+1*e}buildSuperblock(t){let s='<div class="-superblock" data-name="selection">';return s+='<div class="-title"><span class="-similar-products">Categories</span><button class="-switcher -cta">switch</button></div>',s+=this.buildFreelinks(t),s+=this.buildProductFloor(t[0]),s+="</div>",s}updateProductFloor(t){const s=this.categories.find((s=>s.plural_name===t)),e=null==s?void 0:s.skus;this.productMap=null==s?void 0:s.skus,this.productFloorUiUpdate({catObj:s,desc:this.formatPrice(null==s?void 0:s.price_point),name:t,skus:e})}productFloorUiUpdate(t){const{name:s,desc:e,catObj:i,skus:a}=t,r=this.el(".-productfloor");this.el(".-productfloor .-title").innerHTML=`<div class="-title-name">${s}</div><div class="-title-desc">${e}</div>`;const l=this.el(".-skus.-actual",r),n=null==a?void 0:a.map((t=>this.skuHtml(t,i))).join("");l.innerHTML=`<div class="-product-scrollable">${n}</div>`,this.show()}spinLoader(){return'<div aria-label="spinloader" class="spin-loader"></div>'}buildFreelinks(t){let s='<div class="-cats -posrel -single -flipper">';const e=t.map((t=>this.catHtml(t))).join("");return s+=t.length>0?`<div class="-scrollable -front">${e}</div><div class="-back"></div>`:"",s+="</div>",s}catHtml(t){return`<div class="-cat -posrel" data-category="${t.plural_name}" data-url="${t.url}" ><span class="-posabs -preloader -loading"></span><div class="-clickable -posabs" data-type="category" data-category="${t.plural_name}"></div><span class="-posabs -preloader -loading" data-type="category"></span><img class="lazy-image" data-src="${t.image}" alt="${t.plural_name}" /><div class="-posabs -name"><div class="-txt -posabs -name-el">${t.plural_name}</div><div class="-bg -posabs -name-el"></div></div><div class="-price-point">${this.formatPrice(t.price_point)}</div></div>`}buildProductFloor(t){const s=this.isMobile?"":'<div class="-control -prev -posabs" data-dir="prev" data-type="dir-btn"><span class="-posabs -preloader -loading"></span></div><div class="-control -next -posabs"  data-type="dir-btn" data-dir="next"><span class="-posabs -preloader -loading"></span></div>';let e=`<div class="-productfloor active -posrel" data-name="${t.plural_name}">${s}`;e+=`<div class="-head"><div class="-title"><div class="-title-name">${t.plural_name}</div><div class="-title-desc">top deals</div></div><div class="-search-form -posrel"><input type="text" class="-search-input" placeholder="Search for products" /><div class="-cta -search-btn -posabs"><div class="-search-btn-clickable -posabs" data-type="search-btn"></div><div class="search-icon"></div>${this.spinLoader()}</div></div></div>`;const i=t.skus.map((s=>this.skuHtml(s,t))).join("");return this.productMap=t.skus,e+=`<div class="-skus -actual"><div class="-product-scrollable">${i}</div></div>`,e+="</div>",e}skuHtmlHorizontal(t){var s;const e=t.isShopExpress?'<div class="-express -list -posrel"><express></express></div>':"",i=(null===(s=t.badges)||void 0===s?void 0:s.main)?'<span class="-badge -main -official-store">Official Store</span>':"",a=t.rating?`<div class="-product_rating"><div class="-stars -radio-el -posrel -inlineblock -vamiddle"><div class="-in" style="width:${this.rating(t.rating.average)}"></div></div><div class="-count -inlineblock -vabaseline -posrel"><div class="-rt">(${t.rating.totalRatings})</div></div></div>`:"",r=t.prices.oldPrice?this.oldPriceAndDiscount(t):"";return`<div class="-sku -posrel -available" data-sku="${t.sku}"><a href="${t.url}" target="_blank" class="-img -posrel"><span class="-posabs -preloader -hide"></span><img class="lazy-image loaded" data-src="${t.image}" alt="sku_img" /></a><div class="-details"><div class="-name">${t.displayName}</div><div class="-features">${e} ${i} ${a} </div><div class="-prices"><div class="-price -new">${t.prices.price}</div>${r} </div></div><a href="${t.url}" target="_blank" class="-cta -buy -posabs">buy</a></div>`}skuHtml(t,s){const{sku:e,displayName:i,url:a,prices:{price:r,discount:l},image:n}=t,o=l?`<div class="-discount">${l}</div>`:"";return`\n    <div data-sku="${e}" class="-posrel -sku"><div class="-atc-compare"><a href="#initiative" class="-cta -compare" data-sku="${e}" data-singular-name="${s.singular_name}" data-plural-name="${s.plural_name}" data-type="compare">Compare</a></div><a href="${a}" class="-img -posrel"><span class="-posabs -preloader -loading"></span><img class="lazy-image" data-src="${n}" alt="${i}" /></a><div class="-details"><div class="-name">${i}</div><div class="-prices"><div class="-newPrice">${r}</div>${o} </div><div class="-atc-compare"><a href="${a}" class="-cta -atc">Add to cart</a></div></div></div>\n    `}toggleBanner(){this.topBanner.classList.toggle(t.SHOWCLASS);const s=this.hiwCTA.querySelector(t.TXTCLASS);s.textContent=(null==s?void 0:s.textContent)===t.TERMSANDCONDIIONS?t.CLOSE:t.TERMSANDCONDIIONS}setBanner(){return this.el(t.BANNERQUERY).setAttribute(t.DATASRC,this.platform().banner),this}displayTAndCs(){return this.tandcsEl.innerHTML=this.tandcs.map(this.tandcHTML.bind(this)).join(""),this}tandcHTML(t){return`<div class="-rule_element"><div class="-vatop -num">${t.num}</div><div class="-vatop -desc"><div class="-question">${t.question}</div><div class="-answer">${t.answer}</div></div></div>`}}const r=window.Featurebox({config:{apiKey:"AIzaSyAA8dQEt-yZnDyY3Lra8lndRJ3LWNYVW0o",authDomain:"jumia-c15a3.firebaseapp.com",databaseURL:"https://jumia-c15a3.firebaseio.com",projectId:"jumia-c15a3",storageBucket:"jumia-c15a3.appspot.com",messagingSenderId:"295115190934",appId:"1:295115190934:web:de0b33b53a514c3c"}},"about");new r.Database({apiKey:"AIzaSyCKGQw8QCq8qcxJ39QznQgarzOLP_WF1_Q",authDomain:"jumia-17681.firebaseapp.com",databaseURL:"https://jumia-17681.firebaseio.com",projectId:"jumia-17681",storageBucket:"jumia-17681.appspot.com",messagingSenderId:"472156067665",appId:"1:472156067665:web:976495829b072466"}).getAll(t.COLLECTION,t.DOCSEVENT),r.pubsub.subscribe(t.DOCSEVENT,(s=>{let e={categories:[],about:[],config:{countryLocale:"",desktopBanner:"",mobileAppBanner:"",mlp:"",currency:"",domain:"",currencyPosition:""}};Object.keys(s).map((i=>{switch(i){case t.ABOUT:e.about=s[i].list;break;case t.CONFIG:e.config=s[i];break;default:e.categories=s[i].list}})),console.log("remoteData is",e,e.categories[0]),new a(e,r)})),r.pubsub.subscribe(r.FETCHED_DATA,(t=>{}))})();
//# sourceMappingURL=bundle.js.map